{% load input from forms %}
{% load i18n %}

<script type="text/javascript">
$(function () {


    $("#id_ticket_form").on("submit", function () {

        var jqxhr = $.ajax({
            url: $(this).attr("action"),
            method: "post",
            data: $(this).serialize()
        });

        jqxhr.fail(function (xhr) {
            $(".modal").html(xhr.responseText);
        });

        return false;
    });

    // Metodo de auto complete.
    $("#id_cliente").autocomplete({
        appendTo: '.modal-dialog',
        source: function (request, response) {
            $.ajax({
                url: "{% url "minitickets:autocomplete-cliente" %}",
                headers: {'X-CsrfToken': '{{ csrf_token }}'},
                method: "post",
                data: {term: request.term},
                dataType: "json",
                success: function (data) {
                    response(data);
                }
            });
        }
    });

});
</script>

<div class="modal-dialog">
    <div class="modal-content">

        <div class="modal-header">
            <button class="close" aria-hidden="true" data-dismiss="modal" type="button"> Ã— </button>
            <h4 class="modal-title">{{ TITLE }}</h4>

        </div>
        <form  id="id_ticket_form" class="form-horizontal" method="post" action="{{ request.get_full_path }}">
            {% csrf_token %}
            <div class="modal-body">

                {% for field in form.hidden_fields %}
                    {{ field }}
                {% endfor %}

                {% for field in form.visible_fields %}
                    {% input field "label_size"="3" "input_size"="9" %}
                {% endfor %}

                <div class="clearfix"></div>

            </div>

            <div class="modal-footer">
                <button class="btn btn-default" type="button" data-dismiss="modal">{% trans "Cancel" %}</button>
                <button class="btn btn-primary" type="submit">{% trans "Save" %}</button>
            </div>

        </form>
    </div>

</div>